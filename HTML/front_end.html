<!DOCTYPE html><html lang="en">  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>SAM !</title>    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">    <script src="http://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>    <link rel="stylesheet" href="bootstrapValidator.css">    <script type="text/javascript" src="bootstrapValidator.js"></script>    <script src="http://maps.googleapis.com/maps/api/js">    </script>    <style type="text/css">        #tags {            width: 200px;        }    </style>  </head>  <body>    <div style="text-align: center;"><img style="width: 251px; height: 240px;" alt="logo"        src="logo.png"></div>    <div  id="name-group" style="width: 651px; height: 124px; margin-left: 25%" > <input class="form-control" name="name" id="street" placeholder="Search Business"        type="text">      <p style="text-align:left; color:red" id="streetpar">&nbsp;</p>    </div>    <div>      <div style="text-align: center;"><button type="button" id="validateBtn" style="background-color:rgb(84,119,187);"          class="btn btn-success">Search</button></div>      <p id="dmkdkdd">&nbsp;</p>    </div>        <p id="demo"></p>	<table>	<tr>    	<td><div id="here_table"></div></td>    <td valign="top"><div id="googleMap" style="width:500px;height:380px;"></div></td>	</tr>	</table>		<div><strong>Mode of Travel: </strong><select id="mode" onchange="calcRoute();">  <option value="DRIVING">Driving</option>  <option value="WALKING">Walking</option>  <option value="BICYCLING">Bicycling</option>  <option value="TRANSIT">Transit</option></select></div>		<script type="text/javascript">        var x = document.getElementById("demo");        var abc;        var availableTags = [        "ActionScript","AppleScript",        "Asp",        "BASIC",        "C",        "C++",        "Clojure",        "Pappu da dhabba",        "COBOL",        "ColdFusion",        "Erlang",        "Fortran",        "Groovy",        "Haskell",        "Java",        "JavaScript",        "Lisp",        "Perl",        "PHP",        "Python",        "Ruby",        "Scala",        "Scheme"        ];        function split( val )        {        return val.split( / \s*/ );        }        function extractLast( term )         {        return split( term ).pop();        }				var myCenter;		var mynewCenter;				var directionsDisplay;var directionsService = new google.maps.DirectionsService();directionsDisplay = new google.maps.DirectionsRenderer();var origin_lat=37.7699298;var origin_long=-122.4469157;var dest_lat;var dest_long;      function calcRoute() {  var selectedMode = document.getElementById("mode").value;  var request = {      origin: myCenter ,      destination: mynewCenter,           travelMode: google.maps.TravelMode[selectedMode]  };  directionsService.route(request, function(response, status) {    if (status == google.maps.DirectionsStatus.OK) {      directionsDisplay.setDirections(response);    }  });}var l1=0;var l2=0;function success(position) {     l1  = position.coords.latitude;     l2 = position.coords.longitude;           var validity =true;    var valids=true;    $('#street').on('input', function()    {        if (valids)        {            if ( $(this).val().trim() == "")             {                var i = $(this).attr('id') + "par";                var abc = $(this).attr('id');$('#'+i).html("");            }            else             {                var i = $(this).attr('id') + "par";var abc = $(this).attr('id');                $('#'+i).html("&nbsp;");             }        }    });    $('#street').bind( "keydown", function( event ) {    if ( event.keyCode === $.ui.keyCode.TAB && $( this ).data( "autocomplete" ).menu.active )     {        event.preventDefault();    }    }).autocomplete(        {            minLength: 1,            source: function( request, response )             {                // delegate back to autocomplete, but extract the last terms                response( $.ui.autocomplete.filter(availableTags, extractLast( request.term ) ) );            },            focus: function()             {                // prevent value inserted on focus                return false;            },            select: function( event, ui )             {                var terms = split( this.value );                // remove the current input                terms.pop();                // add the selected item                terms.push( ui.item.value );                // add placeholder to get the comma-and-space at the end                terms.push( "" );                this.value = terms.join( " " );                return false;            },            open: function( event, ui )             {                var input = $( event.target ),                widget = input.autocomplete( "widget" ),                style = $.extend( input.css( [                                            "font", "border-left", "padding-left"] ),                 {                    position: "absolute",                    visibility: "hidden",                    "padding-right": 0,                    "border-right": 0,                    "white-space": "pre"                } ),                div = $( "<div/>" ),                pos = {                        my: "left top",                        collision: "none"                    },                offset = -7; // magic number to align the first letter                // in the text field with the first letter                // of suggestions                // depends on how you style the autocomplete box                widget.css( "width", "" );                div                .text( input.val().replace( /\S*$/, "" ) )                .css( style )                .insertAfter( input );                offset = Math.min(                Math.max( offset + div.width(), 0 ),                input.width() - widget.width()                );                div.remove();                pos.at = "left+" + offset + " bottom";                input.autocomplete( "option", "position", pos );                widget.position( $.extend( { of: input }, pos ) );                }                });                $('#validateBtn').click(function(event) {                $("#here_table").empty();                validity =true;                $('input[type="text"]').each(function() {                if ($(this).val().trim() == "") {                var i = $(this).attr('id') + "par";                $('#'+i).html("Hey! You gotta give a query !");                var abc = $(this).attr('id');                validity=validity&false;                }                else {                var i = $(this).attr('id') + "par";                $('#'+i).html("&nbsp;");                 validity=validity&true;                var abc = $(this).attr('id');                }                });                valids=true;                //l1 = 36.114588;                //l2 = -115.161922;                if (validity)                {                    var formData = {                                    'query' : $('input[name=name]').val(),                                    'ranker' : 'comprehensive',									'latitude': l1,									'longitude':l2,                                    };                $.ajax({                type : 'GET',                 url:"http://linserv2.cims.nyu.edu:25808/search",                data : formData,                 dataType : 'json',                encode : true                })                .done(function(data)                 {//console.log(data["1"].address);//console.log(Object.keys(data).length);var mapProp = {                zoom: 15,                mapTypeId: google.maps.MapTypeId.ROADMAP            };var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);directionsDisplay.setMap(map);var image = new google.maps.MarkerImage('tac_business.png', new google.maps.Size(32,36), new google.maps.Point(0,0), new google.maps.Point(0,13));if (navigator.geolocation)    {        navigator.geolocation.getCurrentPosition(function(position) {      myCenter = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);      //myCenter = new google.maps.LatLng(36.114588,-115.161922);      map.setCenter(myCenter);      var image_me = new google.maps.MarkerImage('tac_me.png', new google.maps.Size(32,36), new google.maps.Point(0,0), new google.maps.Point(0,13));      var marker= new google.maps.Marker(                        {                            position: myCenter,                            icon: image_me,                            map: map,                            animation:google.maps.Animation.BOUNCE                        }                        );     });    }     else    {         x.innerHTML = "Geolocation is not supported by this browser.";    }   var infowindow = null;infowindow = new google.maps.InfoWindow({ content: "holding..."  });var content = "<table >"for(i=1; i<=Object.keys(data).length; i++){content += '<tr><td align="left" ><a href='+data[i].url+'>' + data[i].name + '</a></td></tr>';content += '<tr><td align="left" >'+ data[i].address+'</td></tr>';content += '<tr><td align="left" >STARS:' + data[i].star + '      No. of Reviews:'+ data[i].num_reviews+'</td></tr>';content += '<tr><td align="left" >      &nbsp; </td></tr>';content += '<tr><td align="left" >            &nbsp;       </td></tr>';var buisiness_coord= new google.maps.LatLng(data[i].lat,data[i].long);  var marker= new google.maps.Marker(                        {                            position: buisiness_coord,                            icon: image,                            map: map,                            title: data[i].name,                            infowindow: infowindow,                            address: data[i].address,                            animation:google.maps.Animation.DROP                        }                        );google.maps.event.addListener(marker, 'click', function () {  infowindow.setContent(this.title + '<br>' + this.address);  infowindow.open(map, this);mynewCenter= this.position;  });                          }content += "</table>"$('#here_table').append(content);}).fail(function(data) {console.log(data);});event.preventDefault();}event.preventDefault();});                  };  function error() {    alert( "Unable to retrieve your location");  };            			$(document).ready(function() {navigator.geolocation.getCurrentPosition(success, error);   });</script>  </body></html>